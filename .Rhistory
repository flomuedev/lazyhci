" + ",
"(1|",
participant,
")",
sep=""
)
print(formula.aov)
m.aov <- art(as.formula(formula.aov), data=data)
m.lme <- art(as.formula(formula.lme), data=data)
return(list("m.aov" = m.aov, "m.lme" = m.lme))
}
analyze_question <- function(data, question, IVs) {
require(sets)
require(emmeans)
groupnames.sets <- as.list(sets::set_power(IVs))
groupnames.sets <- groupnames.sets[lapply(groupnames.sets,length)>0]
if("package:sets" %in% search()) detach("package:sets", unload=TRUE) # sets is evil.
data <- data %>% filter(!is.na(!!as.name(question)))
IVcols = data %>%
unite(
IVcol, IVs
)
incomplete_participants = data %>%
group_by(participant) %>%
summarise(n = n()) %>%
filter(
n!=length(unique(IVcols$IVcol))
) %>%
select(participant)
data <- data %>% filter(!participant %in% (incomplete_participants %>% pull()))
art <- aov_art_fit.internal(data=data, DV = question, within.vars = IVs, participant = "participant")
likert_model <- likert_plot_model(data=data, DV = question, IVs = IVs, participantCol = "participant", grouping = IVs[[2]], survey_vector = "likert-7")
emmeans <- list()
emmips <- list()
art_cons <- list()
for(set in groupnames.sets) {
vars <- as.list(set)
name = paste(vars, collapse ="_x_")
formula1 <- as.formula(paste("~", paste(vars, collapse = ":"), sep=""))
#~ orientation_undo:movement_visualization
emmeans_tmp <-  emmeans(artlm(art$m.lme, paste(vars, collapse = ":")), formula1)
emmeans[[name]] <- emmeans_tmp
if(length(vars) == 2) {
formula2 <- as.formula(paste(vars[[1]], "~", vars[[2]], sep=""))
emmip_tmp <- emmip(emmeans_tmp, formula2)
emmips[[name]] <- emmip_tmp
#orientation_undo ~ movement_visualization
} else if(length(vars) == 3) {
formula2 <- as.formula(paste(vars[[1]], "~", vars[[2]], " | ", vars[[3]], sep=""))
emmip_tmp <- emmip(emmeans_tmp, formula2)
emmips[[name]] <- emmip_tmp
}
art.con <- art.con(art$m.lme, paste(vars, collapse = ":"))
art_cons[[name]] <- art.con
}
anova <- anova(art$m.aov)
return(list(art=art, anova=anova, artcons = art_cons, likert=likert_model, emmeans = emmeans, emmips = emmips))
}
# filter no_viz
data.with_viz <- data.raw %>% filter(visualization != "No vis")
data.with_viz$visualization <- fct_drop(data.with_viz$visualization)
data.with_viz <- data.with_viz %>%
mutate(
viz_count = case_when(visualization == "single hearts" || visualization == "single ECG"  ~ "Single",
visualization == "multi hearts" || visualization == "multi ECG"  ~ "Multi"
),
viz_style = case_when(visualization == "single hearts" || visualization == "multi hearts"  ~ "Hearts",
visualization == "single ECG" || visualization == "multi ECG"  ~ "ECG"
)
)
data.with_viz.geq_social <- data.with_viz %>% filter(!participant %in% c(16,23,4))
friedman.geq_social <- friedman_with_posthoc(y = data.with_viz.geq_social$geq_social, groups = data.with_viz.geq_social$visualization, blocks = data.with_viz.geq_social$participant)
#check_complete_design(data.with_viz, within.vars = c("visualization"), participantCol = "participant", DV = "vis_evaluation_ifeel_i_got_confused_about_how_others_had_felt_in_the_vr_through_the_heartbeat_visualization")
# -> missing 24,4,16,21,23,34
data.with_viz.vis1 <- data.with_viz %>% filter(!participant %in% c(24,4,16,21,23,34))
friedman_with_posthoc(y = data.with_viz.vis1$vis_evaluation_ifeel_i_understood_how_others_had_felt_the_vr_through_the_heartbeat_visualization, groups = data.with_viz.vis1$visualization, blocks = data.with_viz.vis1$participant)
data.with_viz$viz_count <- as.factor(data.with_viz$viz_count)
data.with_viz$viz_style <- as.factor(data.with_viz$viz_style)
data.with_viz$participant <- as.factor(data.with_viz$participant)
likert.understood.data <- data.with_viz %>%
filter(!is.na(vis_evaluation_ifeel_i_understood_how_others_had_felt_the_vr_through_the_heartbeat_visualization))
likert.understood <- likert_plot_model(data=likert.understood.data, DV = "vis_evaluation_ifeel_i_understood_how_others_had_felt_the_vr_through_the_heartbeat_visualization", IVs = c("viz_count", "viz_style"), participantCol = "participant")
art.understand <- aov_art_fit.internal(data=likert.understood.data, DV = "vis_evaluation_ifeel_i_understood_what_others_had_done_in_the_vr_through_the_heartbeat_visualization", within.vars = c("viz_count", "viz_style"), participant = "participant")
likert.understood <- likert_plot_model(data=likert.understood.data, DV = "vis_evaluation_ifeel_i_understood_what_others_had_done_in_the_vr_through_the_heartbeat_visualization", IVs = c("viz_count", "viz_style"), participantCol = "participant")
## analysis questions
#
questions <- names(data.with_viz)[grep("^vis_evaluation*", names(data.with_viz))]
questions <- questions[-c(5,10)]
results <- list()
for(question in questions) {
print(paste0("Analyzing ", question))
res <- analyze_question(data.with_viz, question, IVs = c("viz_count", "viz_style"))
results[[question]] <- res
}
results$vis_evaluation_the_visualization_distracted_me_from_playing_the_game$anova
results$vis_evaluation_the_visualization_distracted_me_from_playing_the_game$emmeans$viz_count
results$vis_evaluation_the_visualization_distracted_me_from_playing_the_game$artcons$viz_count
results$vis_evaluation_the_visualization_supported_me_in_playing_the_game$anova
results$vis_evaluation_the_visualization_supported_me_in_playing_the_game$emmean$viz_style
results$vis_evaluation_the_visualization_made_me_feel_emotionally_attached_to_other_players$anova
results$vis_evaluation_the_visualization_made_me_feel_emotionally_attached_to_other_players$emmean$viz_style
results$vis_evaluation_the_visualization_made_me_feel_emotionally_attached_to_other_players$emmips$viz_count_x_viz_style
results$vis_evaluation_ifeel_i_understood_how_others_had_felt_the_vr_through_the_heartbeat_visualization$anova
results$vis_evaluation_ifeel_i_understood_what_others_had_done_in_the_vr_through_the_heartbeat_visualization$anova
plots.font.family <- "Linux Biolinum"
colorscale.likert <- c("#a71111", "#cc6621", "#f0d09d", "#ffffe0", "#b9d6c7", "#297878", "#003233")
basesize = 24
basesize.likert = 24
plot.1 <- plot_likert(results$vis_evaluation_the_visualization_distracted_me_from_playing_the_game$likert, ordered = FALSE, percentagelabel = FALSE, theme.fontfamily = plots.font.family, p.basesize = basesize.likert, colorscale = colorscale.likert)
plot.2 <- plot_likert(results$vis_evaluation_the_visualization_supported_me_in_playing_the_game$likert, ordered = FALSE, percentagelabel = FALSE, theme.fontfamily = plots.font.family, p.basesize = basesize.likert, colorscale = colorscale.likert, yblank = TRUE)
plot.3 <- plot_likert(results$vis_evaluation_the_visualization_made_me_feel_emotionally_attached_to_other_players$likert, ordered = FALSE, percentagelabel = FALSE, theme.fontfamily = plots.font.family, p.basesize = basesize.likert, colorscale = colorscale.likert, yblank = TRUE)
plot.4 <- plot_likert(results$vis_evaluation_ifeel_i_understood_how_others_had_felt_the_vr_through_the_heartbeat_visualization$likert, ordered = FALSE, percentagelabel = FALSE, theme.fontfamily = plots.font.family, p.basesize = basesize.likert, colorscale = colorscale.likert)
plot.5 <- plot_likert(results$vis_evaluation_ifeel_i_understood_what_others_had_done_in_the_vr_through_the_heartbeat_visualization$likert, ordered = FALSE, percentagelabel = FALSE, theme.fontfamily = plots.font.family, p.basesize = basesize.likert, colorscale = colorscale.likert, yblank = TRUE)
plot.1
likert.combined <- grid_arrange_shared_legend(plot.1, plot.2, plot.3)
likert.combined <- grid_arrange_shared_legend(plot.1, plot.2, plot.3, plot.4, plot.5)
plot.4 <- plot_likert(results$vis_evaluation_ifeel_i_understood_how_others_had_felt_the_vr_through_the_heartbeat_visualization$likert, ordered = FALSE, percentagelabel = FALSE, theme.fontfamily = plots.font.family, p.basesize = basesize.likert, colorscale = colorscale.likert, yblank=TRUE)
plot.5 <- plot_likert(results$vis_evaluation_ifeel_i_understood_what_others_had_done_in_the_vr_through_the_heartbeat_visualization$likert, ordered = FALSE, percentagelabel = FALSE, theme.fontfamily = plots.font.family, p.basesize = basesize.likert, colorscale = colorscale.likert, yblank = TRUE)
likert.combined <- grid_arrange_shared_legend(plot.1, plot.2, plot.3, plot.4, plot.5)
likert.combined <- grid_arrange_shared_legend(plot.1, plot.2, plot.3, plot.4, plot.5)
ggsave(filename = file.path(getwd(), "PAPER_likert.pdf"), plot = likert.combined, width = 18, height = 5, device = cairo_pdf)
data.raw <- readxl::read_xlsx("34_participants_interim.xlsx", col_names = TRUE, skip = 1) %>%
janitor::clean_names() %>%
rename(
participant = id_eingabe_01,
visualization = vis_type_01
) %>%
mutate(id = row_number()) %>%
rowwise()
library(tidyverse)
library(lazyhci)
library(janitor)
library(emmeans)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
data.raw <- read_csv("flo.csv")
data.raw <- janitor::clean_names(data.raw)
data.raw <- data.raw %>% filter(pid != 3)
data_summary_plot(data=data.raw, DV = "mean_delta_time", IVs = c("stance", "circle", "plane"))
ano <- lazy_analyze(data=data.raw, DV = "distance2target", participant = "pid", within.vars = c("stance", "circle", "plane"), analysis_type = "aov", transformation = "log")
ano <- lazy_analyze(data=data.raw, DV = "mean_delta_time", participant = "pid", within.vars = c("stance", "circle", "plane"), analysis_type = "aov", transformation = "log")
data_summary_plot(data=data.raw, DV = "mean_delta_time", IVs = c("stance", "circle", "plane"))
ano$model$anova_table
ano$post_hoc$circle
ano$post_hoc$circle$`pairwise differences of circle`
ano$post_hoc$circle$`emmeans of circle`
ano$descriptives
View(data.raw)
ano <- lazy_analyze(data=data.raw, DV = "distance2target", participant = "pid", within.vars = c("stance", "circle", "plane"), analysis_type = "aov")
data_summary_plot(data=data.raw, DV = "distance2target", IVs = c("stance", "circle", "plane"))
plot(ano$normality_test)
ano <- lazy_analyze(data=data.raw, DV = "mean_delta_time", participant = "pid", within.vars = c("stance", "circle", "plane", "task_axis"), analysis_type = "aov")
ano$model$anova_table
devtools::document()
devtools::install()
library(tidyverse)
library(lazyhci)
library(janitor)
library(emmeans)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
data.raw <- read_csv("flo.csv")
data.raw <- janitor::clean_names(data.raw)
data.raw <- data.raw %>% filter(pid != 3)
data_summary_plot(data=data.raw, DV = "distance2target", IVs = c("stance", "circle", "plane"))
ano <- lazy_analyze(data=data.raw, DV = "mean_delta_time", participant = "pid", within.vars = c("stance", "circle", "plane", "task_axis"), analysis_type = "aov")
ano$model$anova_table
data_summary_plot(data=data.raw, DV = "mean_delta_time", IVs = c("stance", "circle", "plane", "task_axis"))
View(data.raw)
data_summary_plot(data=data.raw, DV = "mean_delta_time", IVs = c("stance", "circle", "plane", "fnished_task_with_mainhand"))
data_summary_plot(data=data.raw, DV = "mean_delta_time", IVs = c("stance", "circle", "plane", "finished_task_with_mainhand"))
ano <- lazy_analyze(data=data.raw, DV = "mean_delta_time", participant = "pid", within.vars = c("stance", "circle", "plane", "task_axis", "finished_task_with_mainhand"), analysis_type = "aov")
ano <- lazy_analyze(data=data.raw, DV = "mean_delta_time", participant = "pid", within.vars = c("stance", "circle", "plane", "finished_task_with_mainhand"), analysis_type = "aov")
plot(ano$normality_test)
ano$model$anova_table
ano$descriptives$plane
View(data.raw)
data.raw <- data.raw %>% filter(distance2target > 0)
View(data.raw)
data_summary_plot(data=data.raw, DV = "distance2target", IVs = c("stance", "circle", "plane", "finished_task_with_mainhand"))
ano <- lazy_analyze(data=data.raw, DV = "distance2target", participant = "pid", within.vars = c("stance", "circle", "plane"), analysis_type = "aov")
plot(ano$normality_test)
ano <- lazy_analyze(data=data.raw, DV = "distance2target", participant = "pid", within.vars = c("stance", "circle", "plane"), analysis_type = "aov", transformation = "log")
plot(ano$normality_test)
ano$model$anova_table
ano$post_hoc$circle$`pairwise differences of circle`
ano$descriptives$circle
ano$post_hoc$`stance:circle`$`pairwise differences of stance, circle`
ano$post_hoc$`stance:circle`$interaction_plot
ano$post_hoc$`circle:plane`$interaction_plot
ano$post_hoc$`circle:plane`$`pairwise differences of circle, plane`
ano <- lazy_analyze(data=data.raw, DV = "distance2target", participant = "pid", within.vars = c("stance", "circle", "plane", "task_axis"), analysis_type = "aov", transformation = "log")
ano$normality_test
plot(ano$normality_test)
ano$model$anova_table
ano$post_hoc$task_axis
ano$post_hoc$task_axis$`pairwise differences of task_axis`
ano$descriptives$task_axis
ano$post_hoc$`stance:task_axis`$interaction_plot
ano$post_hoc$`stance:task_axis`$`pairwise differences of stance, task_axis`
sessionInfo()
library(tidyverse)
library(lazyhci)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
data.raw <- read_csv("flo.csv")
data.raw <- janitor::clean_names(data.raw)
data.raw <- data.raw %>% filter(pid != 3)
data.raw <- data.raw %>% filter(distance2target > 0)
data_summary_plot(data=data.raw, DV = "distance2target", IVs = c("stance", "circle", "plane", "finished_task_with_mainhand"))
ano <- lazy_analyze(data=data.raw, DV = "distance2target", participant = "pid", within.vars = c("stance", "circle", "plane", "task_axis"), analysis_type = "aov", transformation = "log")
library(tidyverse)
library(readr)
library(readxl)
library(fs)
library(lubridate)
library(janitor)
library(rstatix)
library(PMCMRplus)
library(ARTool)
library(lazyhci)
library(RColorBrewer)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
friedman_with_posthoc <- function(y, groups, blocks, p.adj = "bonf") {
require(PMCMRplus)
friedman <- friedman.test(y = y, groups = groups, blocks = blocks)
result = list(friedman = friedman)
if(friedman$p.value < 0.05) {
post_hoc <- frdAllPairsConoverTest(y = y, groups = groups,
blocks = blocks, p.adjust.method = p.adj)
result = c(result, post_hoc = post_hoc)
}
return(result)
}
data.raw <- readxl::read_xlsx("34_participants_interim.xlsx", col_names = TRUE, skip = 1) %>%
janitor::clean_names() %>%
rename(
participant = id_eingabe_01,
visualization = vis_type_01
) %>%
mutate(id = row_number()) %>%
rowwise() %>%
mutate(
ge_mastery = mean(c(.[id, 4:6], recursive=TRUE)) - 4,
ge_curiosity = mean(c(.[id, 7:9], recursive=TRUE)) - 4,
ge_immersion = mean(c(.[id, 10:12], recursive=TRUE)) - 4,
ge_autonomy = mean(c(.[id, 13:15], recursive=TRUE)) - 4,
ge_meaning = mean(c(.[id, 16:18], recursive=TRUE)) - 4,
ge_ease = mean(c(.[id, 19:21], recursive=TRUE)) - 4,
ge_progress_feedback = mean(c(.[id, 22:24], recursive=TRUE)) - 4,
ge_audiovisual_appeal = mean(c(.[id, 25:27], recursive=TRUE)) - 4,
ge_clarity = mean(c(.[id, 28:30], recursive=TRUE)) - 4,
ge_challenge = mean(c(.[id, 31:33], recursive=TRUE)) -4,
ge_psychosocial = mean(c(.[id, 4:18], recursive=TRUE)) - 4,
ge_functional = mean(c(.[id, 19:33], recursive=TRUE)) - 4,
geq_social = mean(c(.[id, 34:41], recursive=TRUE))
)
data.desc <- readxl::read_xlsx("34_participants_overallComparison.xlsx", col_names = TRUE, skip = 1) %>%
janitor::clean_names() %>%
rename(
participant = id_eingabe_01
) %>%
select(
participant, gender
)
data.new <- inner_join(data.raw, data.desc, by="participant")
data.new$gender <- as.factor(data.new$gender)
data.raw$visualization <- as.factor(data.raw$visualization)
data.raw <- data.raw %>% filter(participant != 30)
data.raw <- data.raw %>%  mutate(
viz_type = ifelse(grepl("ECG", visualization), "ecg",
ifelse(grepl("hearts", visualization), "hearts", "none")),
viz_count = ifelse(grepl("single", visualization), "single",
ifelse(grepl("multi", visualization), "multi", "none"))
)
# filter no_viz
data.with_viz <- data.raw %>% filter(visualization != "No vis")
data.with_viz$visualization <- fct_drop(data.with_viz$visualization)
data.with_viz <- data.with_viz %>%
mutate(
viz_count = case_when(visualization == "single hearts" || visualization == "single ECG"  ~ "Single",
visualization == "multi hearts" || visualization == "multi ECG"  ~ "Multi"
),
viz_style = case_when(visualization == "single hearts" || visualization == "multi hearts"  ~ "Hearts",
visualization == "single ECG" || visualization == "multi ECG"  ~ "ECG"
)
)
data.with_viz.geq_social <- data.with_viz %>% filter(!participant %in% c(16,23,4))
friedman.geq_social <- friedman_with_posthoc(y = data.with_viz.geq_social$geq_social, groups = data.with_viz.geq_social$visualization, blocks = data.with_viz.geq_social$participant)
data.with_viz.vis1 <- data.with_viz %>% filter(!participant %in% c(24,4,16,21,23,34))
friedman_with_posthoc(y = data.with_viz.vis1$vis_evaluation_ifeel_i_understood_how_others_had_felt_the_vr_through_the_heartbeat_visualization, groups = data.with_viz.vis1$visualization, blocks = data.with_viz.vis1$participant)
data.with_viz$viz_count <- as.factor(data.with_viz$viz_count)
data.with_viz$viz_style <- as.factor(data.with_viz$viz_style)
data.with_viz$participant <- as.factor(data.with_viz$participant)
likert.understood.data <- data.with_viz %>%
filter(!is.na(vis_evaluation_ifeel_i_understood_how_others_had_felt_the_vr_through_the_heartbeat_visualization))
likert.understood <- likert_plot_model(data=likert.understood.data, DV = "vis_evaluation_ifeel_i_understood_how_others_had_felt_the_vr_through_the_heartbeat_visualization", IVs = c("viz_count", "viz_style"), participantCol = "participant")
art.understand <- aov_art_fit.internal(data=likert.understood.data, DV = "vis_evaluation_ifeel_i_understood_what_others_had_done_in_the_vr_through_the_heartbeat_visualization", within.vars = c("viz_count", "viz_style"), participant = "participant")
aov_art_fit.internal <- function(data, DV, participant, within.vars = c(), between.vars = c(), posthoc.adj="bonferroni", es = c("ges", "pes", "none"), art.type = c("aov", "lme")) {
require(ARTool)
require(effectsize)
data.internal <- as.data.frame(data)
art.type <- rlang::arg_match(art.type)
es <- rlang::arg_match(es)
formula.aov <- paste(
DV,
" ~ ",
"(",
paste(c(within.vars, between.vars), collapse ="*"),
")",
" + ",
"Error(",
participant,
"/",
"(",
paste(within.vars, collapse ="*"),
"))",
sep=""
)
formula.lme <- paste(
DV,
" ~ ",
"(",
paste(c(within.vars, between.vars), collapse ="*"),
")",
" + ",
"(1|",
participant,
")",
sep=""
)
print(formula.aov)
m.aov <- art(as.formula(formula.aov), data=data)
m.lme <- art(as.formula(formula.lme), data=data)
return(list("m.aov" = m.aov, "m.lme" = m.lme))
}
# filter no_viz
data.with_viz <- data.raw %>% filter(visualization != "No vis")
data.with_viz$visualization <- fct_drop(data.with_viz$visualization)
data.with_viz <- data.with_viz %>%
mutate(
viz_count = case_when(visualization == "single hearts" || visualization == "single ECG"  ~ "Single",
visualization == "multi hearts" || visualization == "multi ECG"  ~ "Multi"
),
viz_style = case_when(visualization == "single hearts" || visualization == "multi hearts"  ~ "Hearts",
visualization == "single ECG" || visualization == "multi ECG"  ~ "ECG"
)
)
data.with_viz.geq_social <- data.with_viz %>% filter(!participant %in% c(16,23,4))
friedman.geq_social <- friedman_with_posthoc(y = data.with_viz.geq_social$geq_social, groups = data.with_viz.geq_social$visualization, blocks = data.with_viz.geq_social$participant)
data.with_viz.vis1 <- data.with_viz %>% filter(!participant %in% c(24,4,16,21,23,34))
friedman_with_posthoc(y = data.with_viz.vis1$vis_evaluation_ifeel_i_understood_how_others_had_felt_the_vr_through_the_heartbeat_visualization, groups = data.with_viz.vis1$visualization, blocks = data.with_viz.vis1$participant)
data.with_viz$viz_count <- as.factor(data.with_viz$viz_count)
data.with_viz$viz_style <- as.factor(data.with_viz$viz_style)
data.with_viz$participant <- as.factor(data.with_viz$participant)
likert.understood.data <- data.with_viz %>%
filter(!is.na(vis_evaluation_ifeel_i_understood_how_others_had_felt_the_vr_through_the_heartbeat_visualization))
likert.understood <- likert_plot_model(data=likert.understood.data, DV = "vis_evaluation_ifeel_i_understood_how_others_had_felt_the_vr_through_the_heartbeat_visualization", IVs = c("viz_count", "viz_style"), participantCol = "participant")
art.understand <- aov_art_fit.internal(data=likert.understood.data, DV = "vis_evaluation_ifeel_i_understood_what_others_had_done_in_the_vr_through_the_heartbeat_visualization", within.vars = c("viz_count", "viz_style"), participant = "participant")
likert.understood <- likert_plot_model(data=likert.understood.data, DV = "vis_evaluation_ifeel_i_understood_what_others_had_done_in_the_vr_through_the_heartbeat_visualization", IVs = c("viz_count", "viz_style"), participantCol = "participant")
questions <- names(data.with_viz)[grep("^vis_evaluation*", names(data.with_viz))]
questions <- questions[-c(5,10)]
results <- list()
for(question in questions) {
print(paste0("Analyzing ", question))
res <- analyze_question(data.with_viz, question, IVs = c("viz_count", "viz_style"))
results[[question]] <- res
}
analyze_question <- function(data, question, IVs) {
require(sets)
require(emmeans)
groupnames.sets <- as.list(sets::set_power(IVs))
groupnames.sets <- groupnames.sets[lapply(groupnames.sets,length)>0]
if("package:sets" %in% search()) detach("package:sets", unload=TRUE) # sets is evil.
data <- data %>% filter(!is.na(!!as.name(question)))
IVcols = data %>%
unite(
IVcol, IVs
)
incomplete_participants = data %>%
group_by(participant) %>%
summarise(n = n()) %>%
filter(
n!=length(unique(IVcols$IVcol))
) %>%
select(participant)
data <- data %>% filter(!participant %in% (incomplete_participants %>% pull()))
art <- aov_art_fit.internal(data=data, DV = question, within.vars = IVs, participant = "participant")
likert_model <- likert_plot_model(data=data, DV = question, IVs = IVs, participantCol = "participant", grouping = IVs[[2]], survey_vector = "likert-7")
emmeans <- list()
emmips <- list()
art_cons <- list()
for(set in groupnames.sets) {
vars <- as.list(set)
name = paste(vars, collapse ="_x_")
formula1 <- as.formula(paste("~", paste(vars, collapse = ":"), sep=""))
#~ orientation_undo:movement_visualization
emmeans_tmp <-  emmeans(artlm(art$m.lme, paste(vars, collapse = ":")), formula1)
emmeans[[name]] <- emmeans_tmp
if(length(vars) == 2) {
formula2 <- as.formula(paste(vars[[1]], "~", vars[[2]], sep=""))
emmip_tmp <- emmip(emmeans_tmp, formula2)
emmips[[name]] <- emmip_tmp
#orientation_undo ~ movement_visualization
} else if(length(vars) == 3) {
formula2 <- as.formula(paste(vars[[1]], "~", vars[[2]], " | ", vars[[3]], sep=""))
emmip_tmp <- emmip(emmeans_tmp, formula2)
emmips[[name]] <- emmip_tmp
}
art.con <- art.con(art$m.lme, paste(vars, collapse = ":"))
art_cons[[name]] <- art.con
}
anova <- anova(art$m.aov)
return(list(art=art, anova=anova, artcons = art_cons, likert=likert_model, emmeans = emmeans, emmips = emmips))
}
# filter no_viz
data.with_viz <- data.raw %>% filter(visualization != "No vis")
data.with_viz$visualization <- fct_drop(data.with_viz$visualization)
data.with_viz <- data.with_viz %>%
mutate(
viz_count = case_when(visualization == "single hearts" || visualization == "single ECG"  ~ "Single",
visualization == "multi hearts" || visualization == "multi ECG"  ~ "Multi"
),
viz_style = case_when(visualization == "single hearts" || visualization == "multi hearts"  ~ "Hearts",
visualization == "single ECG" || visualization == "multi ECG"  ~ "ECG"
)
)
data.with_viz.geq_social <- data.with_viz %>% filter(!participant %in% c(16,23,4))
friedman.geq_social <- friedman_with_posthoc(y = data.with_viz.geq_social$geq_social, groups = data.with_viz.geq_social$visualization, blocks = data.with_viz.geq_social$participant)
data.with_viz.vis1 <- data.with_viz %>% filter(!participant %in% c(24,4,16,21,23,34))
friedman_with_posthoc(y = data.with_viz.vis1$vis_evaluation_ifeel_i_understood_how_others_had_felt_the_vr_through_the_heartbeat_visualization, groups = data.with_viz.vis1$visualization, blocks = data.with_viz.vis1$participant)
data.with_viz$viz_count <- as.factor(data.with_viz$viz_count)
data.with_viz$viz_style <- as.factor(data.with_viz$viz_style)
data.with_viz$participant <- as.factor(data.with_viz$participant)
likert.understood.data <- data.with_viz %>%
filter(!is.na(vis_evaluation_ifeel_i_understood_how_others_had_felt_the_vr_through_the_heartbeat_visualization))
likert.understood <- likert_plot_model(data=likert.understood.data, DV = "vis_evaluation_ifeel_i_understood_how_others_had_felt_the_vr_through_the_heartbeat_visualization", IVs = c("viz_count", "viz_style"), participantCol = "participant")
art.understand <- aov_art_fit.internal(data=likert.understood.data, DV = "vis_evaluation_ifeel_i_understood_what_others_had_done_in_the_vr_through_the_heartbeat_visualization", within.vars = c("viz_count", "viz_style"), participant = "participant")
likert.understood <- likert_plot_model(data=likert.understood.data, DV = "vis_evaluation_ifeel_i_understood_what_others_had_done_in_the_vr_through_the_heartbeat_visualization", IVs = c("viz_count", "viz_style"), participantCol = "participant")
questions <- names(data.with_viz)[grep("^vis_evaluation*", names(data.with_viz))]
questions <- questions[-c(5,10)]
results <- list()
for(question in questions) {
print(paste0("Analyzing ", question))
res <- analyze_question(data.with_viz, question, IVs = c("viz_count", "viz_style"))
results[[question]] <- res
}
results$vis_evaluation_the_visualization_distracted_me_from_playing_the_game$anova
results$vis_evaluation_the_visualization_distracted_me_from_playing_the_game$emmeans$viz_count
results$vis_evaluation_the_visualization_distracted_me_from_playing_the_game$artcons$viz_count
results$vis_evaluation_the_visualization_supported_me_in_playing_the_game$anova
results$vis_evaluation_the_visualization_supported_me_in_playing_the_game$emmean$viz_style
results$vis_evaluation_the_visualization_made_me_feel_emotionally_attached_to_other_players$anova
results$vis_evaluation_the_visualization_made_me_feel_emotionally_attached_to_other_players$emmean$viz_style
results$vis_evaluation_the_visualization_made_me_feel_emotionally_attached_to_other_players$emmips$viz_count_x_viz_style
results$vis_evaluation_ifeel_i_understood_how_others_had_felt_the_vr_through_the_heartbeat_visualization$anova
results$vis_evaluation_ifeel_i_understood_what_others_had_done_in_the_vr_through_the_heartbeat_visualization$anova
plots.font.family <- "Linux Biolinum"
colorscale.likert <- c("#a71111", "#cc6621", "#f0d09d", "#ffffe0", "#b9d6c7", "#297878", "#003233")
basesize = 24
basesize.likert = 24
#colorscale.likert <- c("#a71111", "#cc6621", "#f0d09d", "#ffffe0", "#b9d6c7", "#297878", "#003233")
colorscale.likert <- brewer.pal(7,"Greens")
basesize = 24
basesize.likert = 24
plot.1 <- plot_likert(results$vis_evaluation_the_visualization_distracted_me_from_playing_the_game$likert, ordered = FALSE, percentagelabel = FALSE, theme.fontfamily = plots.font.family, p.basesize = basesize.likert, colorscale = colorscale.likert)
plot.2 <- plot_likert(results$vis_evaluation_the_visualization_supported_me_in_playing_the_game$likert, ordered = FALSE, percentagelabel = FALSE, theme.fontfamily = plots.font.family, p.basesize = basesize.likert, colorscale = colorscale.likert, yblank = TRUE)
plot.3 <- plot_likert(results$vis_evaluation_the_visualization_made_me_feel_emotionally_attached_to_other_players$likert, ordered = FALSE, percentagelabel = FALSE, theme.fontfamily = plots.font.family, p.basesize = basesize.likert, colorscale = colorscale.likert, yblank = TRUE)
plot.4 <- plot_likert(results$vis_evaluation_ifeel_i_understood_how_others_had_felt_the_vr_through_the_heartbeat_visualization$likert, ordered = FALSE, percentagelabel = FALSE, theme.fontfamily = plots.font.family, p.basesize = basesize.likert, colorscale = colorscale.likert, yblank=TRUE)
plot.5 <- plot_likert(results$vis_evaluation_ifeel_i_understood_what_others_had_done_in_the_vr_through_the_heartbeat_visualization$likert, ordered = FALSE, percentagelabel = FALSE, theme.fontfamily = plots.font.family, p.basesize = basesize.likert, colorscale = colorscale.likert, yblank = TRUE)
likert.combined <- grid_arrange_shared_legend(plot.1, plot.2, plot.3, plot.4, plot.5)
ggsave(filename = file.path(getwd(), "PAPER_likert.pdf"), plot = likert.combined, width = 18, height = 5, device = cairo_pdf)
library(lazyhci)
library(tidyverse)
require(ARTool)
require(emmeans)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
### import
res <- import_google_form(url = "https://docs.google.com/spreadsheets/d/13m4gCCju5Iupt6MN2T_jZ8VArEjH0s_iZqNRm30vM3k/edit?usp=sharing",
pre_questions = 5,
post_questions = 14,
nr_of_conditions = 8,
participant_column = 2)
googlesheets4::gs4_deauth()
library(lazyhci)
library(tidyverse)
require(ARTool)
require(emmeans)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
### import
res <- import_google_form(url = "https://docs.google.com/spreadsheets/d/13m4gCCju5Iupt6MN2T_jZ8VArEjH0s_iZqNRm30vM3k/edit?usp=sharing",
pre_questions = 5,
post_questions = 14,
nr_of_conditions = 8,
participant_column = 2)
res$pre <- res$pre %>% filter(participant_id > 0)
res$main <- res$main %>% filter(participant_id > 0)
res$pos <- res$post %>% filter(participant_id > 0)
tlx_raw <- read_csv("https://thomaskosch.com/tlx/nasa_tlx.txt", col_names = c("id", "mental_demand", "physical_demand", "temporal_demand", "performance", "effort", "frustration", "timestamp"))
res$main <- res$main %>%
rename(tlxID = please_have_the_participant_fill_out_the_tlx_questionnaire_on_https_thomaskosch_com_tlx_and_proivde_the_reported_id_here_9)
tlx_raw <- tlx_raw %>%
rename(tlxID = id)
res$main <- merge(res$main, tlx_raw, by = c("tlxID"), all.x = TRUE)
res$main <- res$main %>%
rename(
'Position Undo' = position_support_6,
'Orientation Undo' = orientation_support_7,
'Movement Visualization' = visualization_8
)
res$main <- res$main %>% mutate_at(vars(2:5), as.factor)
t <- res$pre
View(t)
t <- res$main
View(t)
